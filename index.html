<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>智慧連線倉庫管理系統 (完整版)</title>
    
    <!-- 1. 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. 載入 Babel 用於解析 JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 3. 載入外部套件 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-in { animation: fadeIn 0.3s ease-out forwards; }
        * { -webkit-tap-highlight-color: transparent; }
        /* Toggle Switch */
        .toggle-checkbox:checked { right: 0; border-color: #4F46E5; }
        .toggle-checkbox:checked + .toggle-label { background-color: #4F46E5; }
        
        /* 隱藏的匯出容器 (用於生成精美圖片) */
        #hidden-receipt-container {
            position: fixed;
            top: 0;
            left: -9999px;
            width: 500px; /* 設定固定寬度以確保圖片格式統一 */
            background-color: #ffffff;
            z-index: -100;
            padding: 40px;
            box-sizing: border-box;
            font-family: 'Helvetica', 'Arial', sans-serif;
            color: #1f2937;
            line-height: 1.5;
        }
        
        .receipt-header {
            text-align: center;
            border-bottom: 2px dashed #e5e7eb;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }
        .receipt-title { font-size: 24px; font-weight: 900; margin-bottom: 5px; color: #111827; }
        .receipt-subtitle { font-size: 14px; color: #6b7280; }
        
        .receipt-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 700;
            color: #374151;
        }

        .receipt-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .receipt-table th { text-align: left; font-size: 12px; color: #9ca3af; padding-bottom: 8px; border-bottom: 1px solid #e5e7eb; }
        .receipt-table td { padding: 12px 0; border-bottom: 1px solid #f3f4f6; vertical-align: top; }
        .receipt-table .col-name { width: 50%; }
        .receipt-table .col-price { width: 20%; text-align: right; }
        .receipt-table .col-qty { width: 10%; text-align: center; }
        .receipt-table .col-total { width: 20%; text-align: right; font-weight: bold; }
        
        .item-name { font-size: 14px; font-weight: 700; color: #1f2937; display: block; margin-bottom: 2px; }
        .item-spec { font-size: 12px; color: #6b7280; }
        
        .receipt-summary {
            background-color: #f9fafb;
            padding: 20px;
            border-radius: 12px;
            text-align: right;
        }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 14px; }
        .summary-total { display: flex; justify-content: space-between; font-size: 20px; font-weight: 900; color: #4f46e5; margin-top: 10px; border-top: 1px solid #e5e7eb; padding-top: 10px; }
        
        .receipt-footer {
            margin-top: 30px;
            text-align: center;
            font-size: 12px;
            color: #9ca3af;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useMemo, useEffect, useRef } from 'https://esm.sh/react@18.2.0?dev';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client?dev';
        import { 
            LayoutDashboard, Package, ShoppingCart, Users, Zap, Plus, ArrowRight, AlertCircle, 
            CheckCircle2, Combine, Split, MessageCircle, Truck, DollarSign, Search, Filter, 
            X, ChevronRight, ChevronUp, ClipboardList, User, ShoppingBag, ListOrdered, Tag, 
            Layers, Archive, CheckSquare, Square, Trash2, Edit, Save, Copy, CreditCard, 
            RotateCcw, Minus, TrendingUp, Wallet, BoxSelect, Undo2, PackageCheck, FileSpreadsheet,
            Image as ImageIcon, Download, Loader2, Upload, Cloud, Settings, UploadCloud, DownloadCloud, FileJson
        } from 'https://esm.sh/lucide-react@0.263.1?dev';

        const App = () => {
            // --- 1. State Definitions ---
            const loadLocal = (key, def) => {
                const saved = localStorage.getItem(key);
                return saved ? JSON.parse(saved) : def;
            };

            const [products, setProducts] = useState(() => loadLocal('smartwms_products', [
                { id: 'p1', name: '日本極致吹風機', variant: '珍珠白', spot: 2, price: 3200, tierMinQty: 0, tierPrice: 0 },
                { id: 'p2', name: '日本極致吹風機', variant: '消光黑', spot: 3, price: 3200, tierMinQty: 0, tierPrice: 0 },
                { id: 'p3', name: '法式黑巧克力盒', variant: '單一款式', spot: 20, price: 450, tierMinQty: 0, tierPrice: 0 },
            ]));
            const [orders, setOrders] = useState(() => loadLocal('smartwms_orders', [
                { id: 'o1', customer: '林小美', total: 6400, paid: 0, status: '部分到貨', items: [{ productId: 'p1', name: '日本極致吹風機', variant: '珍珠白', qty: 2, allocatedQty: 1, price: 3200 }], debt: 0, unclaimed: 1 },
            ]));
            
            const [apiUrl, setApiUrl] = useState(() => localStorage.getItem('smartwms_api_url') || '');

            // Local Storage Persistence
            useEffect(() => { localStorage.setItem('smartwms_products', JSON.stringify(products)); }, [products]);
            useEffect(() => { localStorage.setItem('smartwms_orders', JSON.stringify(orders)); }, [orders]);
            useEffect(() => { localStorage.setItem('smartwms_api_url', apiUrl); }, [apiUrl]);

            // UI States
            const [activeTab, setActiveTab] = useState('products');
            const [showProxyOrder, setShowProxyOrder] = useState(false);
            const [showPurchaseList, setShowPurchaseList] = useState(false);
            const [showRevenueList, setShowRevenueList] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            
            const [selectedGroupName, setSelectedGroupName] = useState(null); 
            const [selectedCustomerDetail, setSelectedCustomerDetail] = useState(null);
            const [selectedArrivalCustomer, setSelectedArrivalCustomer] = useState(null); 
            
            const [isEditingProduct, setIsEditingProduct] = useState(false);
            const [showPaymentInput, setShowPaymentInput] = useState(false);
            const [paymentAmount, setPaymentAmount] = useState('');
            const [isSyncing, setIsSyncing] = useState(false);
            
            const [editingOrderQtyId, setEditingOrderQtyId] = useState(null);
            const [editingAllocatedQtyId, setEditingAllocatedQtyId] = useState(null);
            const [editingArrivedQtyId, setEditingArrivedQtyId] = useState(null);
            const [editingPurchaseQtyId, setEditingPurchaseQtyId] = useState(null);

            const [isBatchExporting, setIsBatchExporting] = useState(false);
            const [batchProgress, setBatchProgress] = useState(0);
            
            const [selectedCustomerIds, setSelectedCustomerIds] = useState(new Set());
            const [exportTargetCustomer, setExportTargetCustomer] = useState(null); // 用於單張圖片匯出的暫存狀態

            const [proxyForm, setProxyForm] = useState({
                productName: '', variant: '', price: '', customer: '', qty: 1, purchasedQty: 0
            });

            const [notification, setNotification] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            
            const fileInputRef = useRef(null);

            const notify = (msg) => {
                setNotification(msg);
                setTimeout(() => setNotification(null), 3000);
            };

            // --- Data Calculations ---
            const productsWithStats = useMemo(() => {
                return products.map(p => {
                    let allocated = 0; let confirmed = 0; 
                    orders.forEach(o => {
                        if (o.items) {
                            o.items.forEach(item => {
                                if (item.productId === p.id) {
                                    allocated += (item.qty || 0);
                                    confirmed += (item.allocatedQty || 0);
                                }
                            });
                        }
                    });
                    const pending = allocated - confirmed;
                    const totalOwned = (p.spot || 0) + confirmed;
                    const shortage = Math.max(0, allocated - totalOwned);
                    return { ...p, allocated, confirmed, pending, shortage };
                });
            }, [products, orders]);

            const customerList = useMemo(() => {
                const map = {};
                orders.forEach(o => {
                    if (!map[o.customer]) {
                        map[o.customer] = { id: o.customer, name: o.customer, totalSpent: 0, totalPaid: o.paid || 0, orderCount: 0, debt: 0, items: [], rawItems: [] };
                    } else { map[o.customer].totalPaid += (o.paid || 0); }
                    map[o.customer].orderCount += 1;
                    if (o.items) o.items.forEach(item => map[o.customer].rawItems.push({ ...item, orderId: o.id }));
                });

                Object.values(map).forEach(cust => {
                    const nameCounts = {};
                    cust.rawItems.forEach(item => {
                        const productInfo = products.find(p => p.id === item.productId);
                        const productName = productInfo ? productInfo.name : item.name;
                        if (!nameCounts[productName]) nameCounts[productName] = 0;
                        nameCounts[productName] += item.qty;
                    });
                    cust.rawItems.forEach(item => {
                        const productInfo = products.find(p => p.id === item.productId);
                        let finalPrice = item.price;
                        let originalPrice = item.price;
                        let tierMinQty = 0;
                        let tierPrice = 0;
                        if (productInfo) {
                            originalPrice = productInfo.price;
                            tierMinQty = productInfo.tierMinQty;
                            tierPrice = productInfo.tierPrice;
                            const pName = productInfo.name;
                            if (tierMinQty > 0 && nameCounts[pName] >= tierMinQty) finalPrice = tierPrice;
                        }
                        const itemTotal = (item.qty || 0) * finalPrice;
                        cust.items.push({
                            ...item, finalPrice, isDiscounted: finalPrice < originalPrice, itemTotal, isAllocated: (item.allocatedQty || 0) >= item.qty
                        });
                        cust.totalSpent += itemTotal;
                    });
                    cust.debt = Math.max(0, cust.totalSpent - cust.totalPaid);
                });
                return Object.values(map);
            }, [orders, products]);

            const stats = useMemo(() => {
                const totalRevenue = customerList.reduce((acc, curr) => acc + curr.totalSpent, 0); 
                let shortageItemCount = 0; let totalShortageQty = 0;  
                productsWithStats.forEach(p => { if (p.shortage > 0) { shortageItemCount += 1; totalShortageQty += p.shortage; } });
                return { totalRevenue, shortageItemCount, totalShortageQty };
            }, [productsWithStats, customerList]); 

            const arrivalCustomers = useMemo(() => {
                return customerList.map(cust => {
                    const totalItems = cust.items.length;
                    const fullItems = cust.items.filter(i => (i.allocatedQty || 0) >= i.qty).length;
                    const totalQty = cust.items.reduce((s, i) => s + (i.qty || 0), 0);
                    const allocatedQty = cust.items.reduce((s, i) => s + (i.allocatedQty || 0), 0);
                    const isFullyArrived = totalItems > 0 && totalItems === fullItems;
                    return { ...cust, totalItems, fullItems, totalQty, allocatedQty, isFullyArrived };
                }).sort((a,b) => (a.isFullyArrived === b.isFullyArrived ? 0 : a.isFullyArrived ? -1 : 1));
            }, [customerList]);

            const { pendingArrivals, shippedArrivals } = useMemo(() => {
                const pending = [], shipped = [];
                arrivalCustomers.forEach(c => {
                    const hasPending = orders.some(o => o.customer === c.name && o.status !== '已出貨');
                    if (hasPending) pending.push(c);
                    else if (orders.some(o => o.customer === c.name)) shipped.push(c);
                });
                return { pendingArrivals: pending, shippedArrivals: shipped };
            }, [arrivalCustomers, orders]);

            const groupedProducts = useMemo(() => {
                 const groups = {};
                 products.forEach(p => {
                     if(!groups[p.name]) groups[p.name] = { ...p, variants: [], totalAllocated:0, totalConfirmed:0, totalSpot:0 };
                     groups[p.name].variants.push(p);
                     const stats = productsWithStats.find(ps => ps.id === p.id);
                     if(stats) {
                         groups[p.name].totalAllocated += stats.allocated;
                         groups[p.name].totalConfirmed += stats.confirmed;
                         groups[p.name].totalSpot += (p.spot || 0);
                     }
                 });
                 return Object.values(groups);
            }, [products, productsWithStats]);

            const purchaseList = useMemo(() => productsWithStats.filter(p => p.shortage > 0).map(p => ({ ...p })), [productsWithStats]);
            const revenueCustomers = useMemo(() => customerList.filter(c => c.totalSpent > 0).sort((a, b) => b.totalSpent - a.totalSpent), [customerList]);

            const filteredGroupedProducts = groupedProducts.filter(g => g.name.includes(searchQuery));
            const filteredCustomers = customerList.filter(c => c.name.includes(searchQuery));
            const filteredPendingArrivals = pendingArrivals.filter(c => c.name.includes(searchQuery));
            const filteredShippedArrivals = shippedArrivals.filter(c => c.name.includes(searchQuery));
            
            const availableVariants = useMemo(() => [...new Set(products.filter(p => p.name === proxyForm.productName).map(p => p.variant))], [products, proxyForm.productName]);

            // --- Handlers ---
            const handleExportBackup = () => {
                const data = { products, orders, timestamp: new Date().toISOString() };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
                saveAs(blob, `SmartWMS_Backup_${new Date().toISOString().slice(0,10)}.json`);
                notify("備份檔已下載");
            };

            const handleImportBackup = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.products && data.orders) {
                            if(confirm(`確定要還原備份資料嗎？\n備份時間: ${data.timestamp || '未知'}\n目前的資料將被覆蓋！`)) {
                                setProducts(data.products);
                                setOrders(data.orders);
                                notify("資料還原成功！");
                            }
                        } else {
                            notify("無效的備份檔案格式");
                        }
                    } catch (err) { console.error(err); notify("讀取檔案失敗"); }
                    event.target.value = '';
                };
                reader.readAsText(file);
            };

            // 精美的圖片匯出功能
            const handleExportToImage = async (customer) => {
                if (!customer) return;
                
                // 設定要渲染的隱藏容器內容
                setExportTargetCustomer(customer);
                
                // 等待 React 渲染 DOM
                await new Promise(resolve => setTimeout(resolve, 100));

                const element = document.getElementById('hidden-receipt-container');
                if (!element) return;
                
                try {
                    const canvas = await html2canvas(element, { 
                        useCORS: true, 
                        backgroundColor: '#ffffff', 
                        scale: 2 
                    });
                    const dataUrl = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.download = `${customer.name}_訂單明細.png`;
                    link.href = dataUrl;
                    link.click();
                    notify("圖片已匯出");
                } catch (err) { 
                    console.error(err); 
                    notify("匯出失敗"); 
                } finally {
                    setExportTargetCustomer(null); // 清除隱藏內容
                }
            };
            
            const handleClearData = () => {
                if (confirm("⚠️ 警告：您確定要清除所有資料嗎？\n\n此操作將清空所有商品與訂單，讓您重新開始。\n請務必確認您已備份！")) {
                    setProducts([]);
                    setOrders([]);
                    notify("系統資料已全部清除");
                }
            };

            // ... (Other handlers unchanged, including API sync functions)
            // For brevity, using placeholder for repetitive logic which is same as before
            const navigateTo = (tab) => { setActiveTab(tab); setSearchQuery(''); };
            const handleProxyProductChange = (e) => { const name = e.target.value; const existing = products.find(p => p.name === name); setProxyForm(prev => ({ ...prev, productName: name, price: existing ? existing.price : prev.price })); };
            const handleUpdateOrderQty = (oid, pid, v) => { const q = parseInt(v); if(isNaN(q)) return; setOrders(prev => prev.map(o => o.id===oid ? {...o, items: o.items.map(i=>i.productId===pid?{...i,qty:q}:i).filter(i=>i.qty>0)} : o).filter(o=>o.items.length>0)); setEditingOrderQtyId(null); };
            const handleUpdateAllocatedQty = (oid, pid, v) => { const q = parseInt(v); if(isNaN(q)) return; const order = orders.find(o=>o.id===oid); const item = order.items.find(i=>i.productId===pid); const prod = products.find(p=>p.id===pid); if(q>item.qty){ notify("不可大於喊單"); return; } const diff = q - (item.allocatedQty||0); setOrders(prev=>prev.map(o=>o.id===oid?{...o,items:o.items.map(i=>i.productId===pid?{...i,allocatedQty:q}:i)}:o)); setProducts(prev=>prev.map(p=>p.id===pid?{...p,spot:(p.spot||0)-diff}:p)); setEditingAllocatedQtyId(null); };
            const handleUpdatePurchaseQty = (pid, v) => { const q = parseInt(v); if(isNaN(q)) return; const p = productsWithStats.find(x=>x.id===pid); if(p){ const newSpot = p.allocated - p.confirmed - q; setProducts(prev=>prev.map(x=>x.id===pid?{...x,spot:newSpot}:x)); setEditingPurchaseQtyId(null); } };
            const handleDeleteOrderItem = (oid, pid) => { if(confirm("刪除?")) { const order = orders.find(o=>o.id===oid); const item = order.items.find(i=>i.productId===pid); if(item?.allocatedQty>0){ setProducts(prev=>prev.map(p=>p.id===pid?{...p,spot:(p.spot||0)+item.allocatedQty}:p)); } setOrders(prev=>prev.map(o=>o.id===oid?{...o,items:o.items.filter(i=>i.productId!==pid)}:o).filter(o=>o.items.length>0)); } };
            const handleUpdateProductInfo = (pid, f, v) => { const val = parseInt(v); if(isNaN(val)) return; const t = products.find(p=>p.id===pid); setProducts(prev=>prev.map(p=> (f.startsWith('tier') && p.name===t.name) || p.id===pid ? {...p, [f]:val} : p)); };
            const handleDeleteProduct = (pid) => { if(confirm("刪除款式?")) setProducts(prev=>prev.filter(p=>p.id!==pid)); };
            const handleDeleteProductGroup = (name,e) => { e.stopPropagation(); if(confirm(`刪除 ${name}?`)) { setProducts(prev=>prev.filter(p=>p.name!==name)); setSelectedGroupName(null); } };
            const handleDeleteCustomer = (name,e) => { e.stopPropagation(); if(confirm(`刪除 ${name}?`)) { setOrders(prev=>prev.filter(o=>o.customer!==name)); if(selectedCustomerDetail?.name===name) setSelectedCustomerDetail(null); } };
            const toggleAllocation = (oid, pid, curr, total) => { const next = curr >= total ? 0 : total; const diff = next - curr; const p = products.find(x=>x.id===pid); if(diff>0&&(p.spot||0)<diff) notify("現貨不足"); setOrders(prev=>prev.map(o=>o.id===oid?{...o,items:o.items.map(i=>i.productId===pid?{...i,allocatedQty:next}:i)}:o)); setProducts(prev=>prev.map(p=>p.id===pid?{...p,spot:(p.spot||0)-diff}:p)); };
            const handleShipCustomer = (name) => { if(confirm("確認出貨?")) { setOrders(prev=>prev.map(o=>o.customer===name&&o.status!=='已出貨'?{...o,status:'已出貨'}:o)); setSelectedArrivalCustomer(null); } };
            const handleUnshipCustomer = (name) => { if(confirm("回復未出貨?")) { setOrders(prev=>prev.map(o=>o.customer===name&&o.status==='已出貨'?{...o,status:'待結單'}:o)); setSelectedArrivalCustomer(null); } };
            const handleAddOrder = () => { const { productName, variant, price, customer, qty, purchasedQty } = proxyForm; if (!productName || !price) { notify('請填寫完整'); return; } const q = parseInt(qty)||1; const pq = parseInt(purchasedQty)||0; const fp = parseInt(price)||0; let target = products.find(p=>p.name===productName && p.variant===variant); let pid = target?.id; if(!target) { pid = Date.now().toString(); setProducts(prev=>[...prev, {id:pid, name:productName, variant:variant||'單一款式', price:fp, spot:pq, tierMinQty:0, tierPrice:0}]); } else if(pq>0) { setProducts(prev=>prev.map(p=>p.id===pid?{...p,spot:(p.spot||0)+pq}:p)); } if(customer) { setOrders(prev=>[...prev, { id: Date.now().toString()+Math.random(), customer, total:fp*q, paid:0, status:'待結單', items:[{productId:pid, name:productName, variant:variant||'單一款式', qty:q, price:fp, allocatedQty:0}], debt:0, unclaimed:0 }]); notify("已加單"); } else { notify("已入庫"); } setShowProxyOrder(false); setProxyForm({ productName: '', variant: '', price: '', customer: '', qty: 1, purchasedQty: 0 }); };
            
            const handleCloudUpload = async () => { if(!apiUrl) { notify("請設定API"); return; } setIsSyncing(true); try { await fetch(apiUrl, { method:'POST', mode:'no-cors', headers:{'Content-Type':'application/json'}, body:JSON.stringify({products,orders}) }); notify("上傳成功"); } catch(e) { notify("上傳失敗"); } finally { setIsSyncing(false); } };
            const handleCloudDownload = async () => { if(!apiUrl) { notify("請設定API"); return; } setIsSyncing(true); try { const res = await fetch(apiUrl); const data = await res.json(); if(data.products){ if(confirm("覆蓋資料?")){ setProducts(data.products); setOrders(data.orders); notify("下載成功"); } } } catch(e) { notify("下載失敗"); } finally { setIsSyncing(false); } };
            
            // 確保選中物件更新
            const currentSelectedCustomer = selectedCustomerDetail ? customerList.find(c => c.name === selectedCustomerDetail.name) : null;
            
            // 修正：在渲染時動態查找對應清單中的顧客物件
            const currentSelectedArrivalCustomer = selectedArrivalCustomer
                ? (selectedArrivalCustomer.source === 'shipped' 
                    ? shippedArrivals.find(c => c.name === selectedArrivalCustomer.name) 
                    : pendingArrivals.find(c => c.name === selectedArrivalCustomer.name)) 
                  || selectedArrivalCustomer 
                : null;
            const isArrivalShipped = currentSelectedArrivalCustomer && !orders.some(o => o.customer === currentSelectedArrivalCustomer.name && o.status !== '已出貨');

            // --- Render ---
            return (
                <div className="min-h-screen pb-24">
                    {/* Hidden Receipt for Image Generation */}
                    {exportTargetCustomer && (
                        <div id="hidden-receipt-container">
                            <div className="receipt-header">
                                <div className="receipt-title">{exportTargetCustomer.name} 的購物清單</div>
                                <div className="receipt-subtitle">{new Date().toLocaleString()}</div>
                            </div>
                            <div className="receipt-info">
                                <span>訂單編號: {Date.now().toString().slice(-6)}</span>
                                <span>客戶: {exportTargetCustomer.name}</span>
                            </div>
                            <table className="receipt-table">
                                <thead>
                                    <tr>
                                        <th className="col-name">商品 / 規格</th>
                                        <th className="col-price">單價</th>
                                        <th className="col-qty">數量</th>
                                        <th className="col-total">小計</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {exportTargetCustomer.items.map((item, idx) => (
                                        <tr key={idx}>
                                            <td className="col-name">
                                                <span className="item-name">{item.name}</span>
                                                <span className="item-spec">{item.variant}</span>
                                            </td>
                                            <td className="col-price">${item.finalPrice}</td>
                                            <td className="col-qty">{item.qty}</td>
                                            <td className="col-total">${item.itemTotal}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                            <div className="receipt-summary">
                                <div className="summary-row">
                                    <span>項目總數:</span>
                                    <span>{exportTargetCustomer.items.length} 項</span>
                                </div>
                                <div className="summary-total">
                                    <span>總金額:</span>
                                    <span>${exportTargetCustomer.totalSpent.toLocaleString()}</span>
                                </div>
                            </div>
                            <div className="receipt-footer">
                                感謝您的購買！請於期限內完成匯款。
                            </div>
                        </div>
                    )}

                    {notification && <div className="fixed top-20 left-1/2 -translate-x-1/2 z-[300] bg-slate-800 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-bounce"><CheckCircle2 size={18} className="text-green-400" />{notification}</div>}

                    {/* Header */}
                    <div className="bg-indigo-600 text-white p-4 shadow-lg sticky top-0 z-50 flex justify-between items-center max-w-2xl mx-auto">
                        <h1 className="text-xl font-bold flex items-center gap-2" onClick={() => navigateTo('dashboard')}><Zap className="fill-yellow-400 text-yellow-400" /> Smart WMS <span className="text-[10px] bg-white/20 px-2 py-1 rounded">API+Local</span></h1>
                    </div>

                    {/* Nav */}
                    <div className="bg-white border-b sticky top-[60px] z-40">
                         <div className="flex max-w-2xl mx-auto overflow-x-auto no-scrollbar">
                            {[{id:'products',l:'商品列表',i:ShoppingBag},{id:'dashboard',l:'狀態',i:LayoutDashboard},{id:'customers',l:'顧客列表',i:Users},{id:'arrivals',l:'到貨管理',i:BoxSelect}].map(t => (
                                <button key={t.id} onClick={() => {setActiveTab(t.id); setSearchQuery('')}} className={`flex-1 py-4 px-2 flex flex-col items-center gap-1 text-[10px] font-bold ${activeTab === t.id ? 'text-indigo-600 border-b-2 border-indigo-600' : 'text-slate-400'}`}><t.i size={18}/>{t.l}</button>
                            ))}
                        </div>
                    </div>

                    {/* Content */}
                    <main className="max-w-2xl mx-auto p-4 space-y-4">
                        {activeTab !== 'dashboard' && <div className="relative"><input type="text" placeholder="搜尋..." value={searchQuery} onChange={e => setSearchQuery(e.target.value)} className="w-full bg-white rounded-2xl p-4 pl-12 shadow-sm outline-none" /><Search size={18} className="absolute left-4 top-4 text-slate-300" /></div>}
                        
                        {/* Sidebar Backup Buttons */}
                        <div className="flex gap-2 overflow-x-auto pb-2">
                             <button onClick={()=>setShowSettings(true)} className="bg-slate-200 text-slate-700 px-3 py-2 rounded-xl text-xs flex items-center gap-1 shrink-0"><Settings size={14}/> API 設定</button>
                             <button onClick={handleCloudUpload} className="bg-indigo-600 text-white px-3 py-2 rounded-xl text-xs flex items-center gap-1 shrink-0"><Cloud size={14}/> 上傳雲端</button>
                             <button onClick={handleCloudDownload} className="bg-emerald-600 text-white px-3 py-2 rounded-xl text-xs flex items-center gap-1 shrink-0"><Download size={14}/> 雲端同步</button>
                             <div className="w-px bg-slate-300 mx-1 shrink-0"></div>
                             <button onClick={handleExportBackup} className="bg-slate-700 text-white px-3 py-2 rounded-xl text-xs flex items-center gap-1 shrink-0"><Download size={14}/> 備份檔案</button>
                             <label className="bg-slate-200 text-slate-700 px-3 py-2 rounded-xl text-xs flex items-center gap-1 cursor-pointer shrink-0">
                                <Upload size={14}/> 還原檔案
                                <input type="file" ref={fileInputRef} onChange={handleImportBackup} accept=".json" className="hidden" />
                             </label>
                             <div className="w-px bg-slate-300 mx-1 shrink-0"></div>
                             <button onClick={handleClearData} className="bg-rose-600 text-white px-3 py-2 rounded-xl text-xs flex items-center gap-1 shrink-0"><Trash2 size={14}/> 清除重置</button>
                        </div>

                        {/* Products */}
                        {activeTab === 'products' && filteredGroupedProducts.map(g => (
                            <div key={g.name} onClick={() => setSelectedGroupName(g.name)} className="bg-white rounded-3xl p-4 shadow-sm border border-slate-100 flex justify-between items-center cursor-pointer active:scale-98">
                                <div className="flex-1">
                                    <h4 className="font-black text-slate-800 text-lg">{g.name}</h4>
                                    <div className="flex gap-3 mt-1 text-xs text-slate-500">
                                        <span>喊 {g.totalAllocated}</span><span>配 {g.totalConfirmed}</span><span>現 {g.totalSpot}</span>
                                    </div>
                                </div>
                                <ChevronRight className="text-slate-300" />
                            </div>
                        ))}

                        {/* Dashboard */}
                        {activeTab === 'dashboard' && (
                            <div className="grid grid-cols-2 gap-4">
                                <div onClick={() => setShowPurchaseList(true)} className="bg-rose-500 text-white p-4 rounded-3xl shadow-lg relative overflow-hidden cursor-pointer">
                                    <p className="text-xs font-bold opacity-80">需補貨</p>
                                    <p className="text-2xl font-black mt-1">{stats.totalShortageQty} 件</p>
                                </div>
                                <div onClick={() => setShowRevenueList(true)} className="bg-amber-500 text-white p-4 rounded-3xl shadow-lg relative overflow-hidden cursor-pointer">
                                    <p className="text-xs font-bold opacity-80">總營業額</p>
                                    <p className="text-2xl font-black mt-1">${stats.totalRevenue.toLocaleString()}</p>
                                </div>
                            </div>
                        )}

                        {/* Customers */}
                        {activeTab === 'customers' && filteredCustomers.map(c => (
                            <div key={c.name} onClick={() => setSelectedCustomerDetail(c)} className="bg-white rounded-3xl p-4 shadow-sm border border-slate-100 flex justify-between items-center cursor-pointer mb-2">
                                <div className="flex items-center gap-3"><div className="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center font-bold">{c.name[0]}</div><h4 className="font-bold text-slate-800">{c.name}</h4></div>
                                <p className="font-black text-indigo-600">${c.totalSpent.toLocaleString()}</p>
                            </div>
                        ))}

                        {/* Arrivals */}
                        {activeTab === 'arrivals' && (
                            <div className="space-y-6 pb-24">
                                <div>
                                    <h3 className="text-lg font-black text-slate-800 mb-3 px-2 flex gap-2"><BoxSelect size={20} className="text-indigo-600"/> 待出貨 / 到貨中</h3>
                                    {filteredPendingArrivals.map(c => (
                                        <div key={c.name} onClick={() => setSelectedArrivalCustomer({...c, source: 'pending'})} className="bg-white rounded-3xl shadow-sm border border-slate-100 p-4 mb-3 flex justify-between items-center cursor-pointer relative overflow-hidden">
                                            {c.isFullyArrived && <div className="absolute left-0 top-0 bottom-0 w-1.5 bg-emerald-500"></div>}
                                            <div className="flex items-center gap-3">
                                                <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold ${c.isFullyArrived ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-100 text-slate-500'}`}>{c.name[0]}</div>
                                                <div>
                                                    <h4 className="font-bold text-slate-800 flex gap-2 items-center">{c.name} {c.isFullyArrived && <span className="text-[10px] bg-emerald-100 text-emerald-600 px-2 rounded-full">全到</span>}</h4>
                                                    <p className="text-xs text-slate-500">共 {c.totalQty} 件 · 已配 {c.allocatedQty}</p>
                                                </div>
                                            </div>
                                            {c.isFullyArrived && <button onClick={(e) => { e.stopPropagation(); handleShipCustomer(c.name); }} className="bg-emerald-500 text-white px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-1 shadow animate-pulse"><Truck size={14}/> 確認出貨</button>}
                                        </div>
                                    ))}
                                </div>
                                <div className="opacity-60">
                                    <h3 className="text-lg font-black text-slate-500 mb-3 px-2 flex gap-2"><PackageCheck size={20}/> 已出貨紀錄</h3>
                                    {filteredShippedArrivals.map(c => (
                                        <div key={c.name} onClick={() => setSelectedArrivalCustomer({...c, source: 'shipped'})} className="bg-slate-50 rounded-3xl p-4 border border-slate-100 mb-3 flex justify-between items-center cursor-pointer">
                                            <span className="font-bold text-slate-600">{c.name}</span>
                                            <span className="text-xs bg-gray-200 px-2 py-1 rounded-full">已出貨</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </main>

                    <div className="fixed bottom-6 right-6 z-[100]"><button onClick={() => setShowProxyOrder(true)} className="w-16 h-16 bg-indigo-600 text-white rounded-full shadow-2xl flex items-center justify-center active:scale-95 transition-all"><Plus size={32}/></button></div>

                    {/* Modals */}
                    {/* Settings Modal */}
                    {showSettings && (
                        <div className="fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4">
                            <div className="bg-white rounded-3xl w-full max-w-md p-6 space-y-4">
                                <h3 className="font-bold border-b pb-2">API 設定</h3>
                                <p className="text-sm text-slate-500">請輸入 Google Apps Script 網頁應用程式網址</p>
                                <input type="text" placeholder="https://script.google.com/..." className="w-full border p-3 rounded-xl" value={apiUrl} onChange={e=>setApiUrl(e.target.value)}/>
                                <div className="flex gap-2">
                                    <button onClick={()=>setShowSettings(false)} className="flex-1 bg-indigo-600 text-white py-3 rounded-lg font-bold">儲存</button>
                                    <button onClick={()=>setShowSettings(false)} className="flex-1 bg-slate-100 text-slate-500 py-3 rounded-lg font-bold">取消</button>
                                </div>
                            </div>
                        </div>
                    )}
                    {showProxyOrder && <div className="fixed inset-0 bg-black/50 z-[200] flex items-end md:items-center justify-center p-4"><div className="bg-white rounded-3xl w-full max-w-md p-5 space-y-4"><h3 className="font-bold border-b pb-2">代客加單/入庫</h3><input placeholder="商品名稱" className="w-full border p-2 rounded" list="pl" value={proxyForm.productName} onChange={handleProxyProductChange}/><datalist id="pl">{[...new Set(products.map(p=>p.name))].map(n=><option key={n} value={n}/>)}</datalist><div className="flex gap-2"><input placeholder="款式" className="w-full border p-2 rounded" list="vl" value={proxyForm.variant} onChange={e=>setProxyForm({...proxyForm,variant:e.target.value})}/><datalist id="vl">{availableVariants.map(v=><option key={v} value={v}/>)}</datalist><input type="number" placeholder="$" className="w-20 border p-2 rounded" value={proxyForm.price} onChange={e=>setProxyForm({...proxyForm,price:e.target.value})}/></div><div className="flex gap-2"><input placeholder="顧客(選填)" className="w-full border p-2 rounded" list="cl" value={proxyForm.customer} onChange={e=>setProxyForm({...proxyForm,customer:e.target.value})}/><datalist id="cl">{customerList.map(c=><option key={c.name} value={c.name}/>)}</datalist><input type="number" placeholder="數" className="w-20 border p-2 rounded" value={proxyForm.qty} onChange={e=>setProxyForm({...proxyForm,qty:e.target.value})}/></div><input type="number" placeholder="購買/現貨數量" className="w-full border p-2 rounded bg-indigo-50" value={proxyForm.purchasedQty} onChange={e=>setProxyForm({...proxyForm,purchasedQty:e.target.value})}/><button onClick={handleAddOrder} className="w-full bg-indigo-600 text-white py-3 rounded-lg font-bold">確認</button><button onClick={()=>setShowProxyOrder(false)} className="w-full mt-2 text-slate-400 text-sm">取消</button></div></div>}

                    {showRevenueList && <div className="fixed inset-0 bg-black/50 z-[150] flex items-center justify-center p-4"><div className="bg-white rounded-3xl w-full max-w-md h-[80vh] flex flex-col"><div className="p-4 border-b flex justify-between"><h3>營收總覽</h3><button onClick={()=>setShowRevenueList(false)}><X/></button></div><div className="flex-1 overflow-y-auto p-4 space-y-2">{revenueCustomers.map(c=><div key={c.name} onClick={()=>{setShowRevenueList(false);setSelectedCustomerDetail(c)}} className="flex justify-between p-3 border rounded-xl items-center cursor-pointer"><span className="font-bold">{c.name}</span><span>${c.totalSpent.toLocaleString()}</span></div>)}</div></div></div>}
                    
                    {showPurchaseList && <div className="fixed inset-0 bg-black/50 z-[150] flex items-center justify-center p-4"><div className="bg-white rounded-3xl w-full max-w-md h-[80vh] flex flex-col"><div className="p-4 border-b flex justify-between"><h3>採購清單</h3><button onClick={()=>setShowPurchaseList(false)}><X/></button></div><div className="flex-1 overflow-y-auto p-4 space-y-2">{purchaseList.map(p=><div key={p.id} className="flex justify-between p-3 border-b"><div><div className="font-bold">{p.name}</div><div className="text-xs text-slate-500">{p.variant}</div></div><div className="flex items-center gap-2"><span className="text-xs text-slate-400">缺</span>{editingPurchaseQtyId===p.id?<input autoFocus className="w-12 border rounded text-center" type="number" defaultValue={p.shortage} onBlur={e=>handleUpdatePurchaseQty(p.id,e.target.value)}/>:<span onClick={()=>setEditingPurchaseQtyId(p.id)} className="text-rose-600 font-black text-lg cursor-pointer">{p.shortage}</span>}</div></div>)}</div></div></div>}

                    {selectedGroupName && <div className="fixed inset-0 bg-black/50 z-[150] flex items-end md:items-center justify-center p-0 md:p-4"><div className="bg-white rounded-t-[30px] md:rounded-3xl w-full max-w-md h-[85vh] flex flex-col"><div className="p-6 border-b flex justify-between"><h3>{selectedGroupName}</h3><button onClick={()=>setSelectedGroupName(null)}><X/></button></div><div className="flex-1 overflow-y-auto p-4 space-y-4">
                        <div className="bg-slate-50 p-3 rounded-xl"><table className="w-full text-xs text-center"><thead><tr className="text-slate-400"><th>款式</th><th>已配</th><th>待配</th><th>現貨</th>{isEditingProduct&&<th></th>}</tr></thead><tbody>{productsWithStats.filter(p=>p.name===selectedGroupName).map(p=><tr key={p.id}><td className="py-2 text-left">{p.variant}</td><td className="text-indigo-600">{p.confirmed}</td><td className="text-rose-500">{p.pending}</td><td>{isEditingProduct?<input className="w-10 text-center border rounded" defaultValue={p.spot} onBlur={e=>handleUpdateProductInfo(p.id,'spot',e.target.value)}/>:p.spot}</td>{isEditingProduct&&<td><button onClick={()=>handleDeleteProduct(p.id)} className="text-rose-500"><Trash2 size={14}/></button></td>}</tr>)}</tbody></table></div>
                        <div><h4 className="text-xs font-bold text-slate-400 mb-2">配貨明細 (點擊修改數量)</h4>{getGroupAllocations(selectedGroupName).map((r,i)=><div key={i} className="flex justify-between items-center p-3 border rounded-xl mb-2"><div className="flex items-center gap-3"><button onClick={()=>toggleAllocation(r.orderId,r.productId,r.allocatedQty,r.qty)} className={`w-6 h-6 rounded border flex items-center justify-center ${r.isAllocated?'bg-indigo-600 text-white':''}`}><CheckSquare size={14}/></button><div><div className="font-bold text-sm">{r.customer}</div><div className="text-[10px] text-slate-500">{r.variant}</div></div></div><div className="flex items-center gap-1 text-sm"><span className="text-slate-400 text-xs">配</span>{editingAllocatedQtyId===`${r.orderId}-${r.productId}-detail`?<input autoFocus className="w-8 text-center border-b border-indigo-500 outline-none bg-transparent" defaultValue={r.allocatedQty} onBlur={e=>handleUpdateAllocatedQty(r.orderId,r.productId,e.target.value)}/>:<span onClick={()=>setEditingAllocatedQtyId(`${r.orderId}-${r.productId}-detail`)} className="font-bold text-indigo-600 cursor-pointer">{r.allocatedQty}</span>}<span className="text-slate-400 text-xs">/ 喊</span>{editingOrderQtyId===`${r.orderId}-${r.productId}-detail`?<input autoFocus className="w-8 text-center border-b border-slate-500 outline-none bg-transparent" defaultValue={r.qty} onBlur={e=>handleUpdateOrderQty(r.orderId,r.productId,e.target.value)}/>:<span onClick={()=>setEditingOrderQtyId(`${r.orderId}-${r.productId}-detail`)} className="font-bold cursor-pointer">{r.qty}</span>}</div></div>)}</div>
                    </div><div className="p-4 border-t flex justify-between"><button onClick={()=>{setProxyForm(prev=>({...prev,productName:selectedGroupName}));setShowProxyOrder(true)}} className="text-sm bg-slate-100 px-3 py-2 rounded-lg flex gap-1"><Plus size={16}/> 加單</button><button onClick={()=>setIsEditingProduct(!isEditingProduct)} className="text-sm bg-slate-100 px-3 py-2 rounded-lg flex gap-1"><Edit size={16}/> 編輯</button></div></div></div>}

                    {selectedCustomerDetail && currentSelectedCustomer && (
                        <div className="fixed inset-0 bg-black/50 z-[160] flex items-end md:items-center justify-center p-0 md:p-4">
                            <div className="bg-white rounded-t-[30px] md:rounded-3xl w-full max-w-md h-[85vh] flex flex-col">
                                <div className="p-6 border-b flex justify-between items-start">
                                    <div><h3 className="text-xl font-bold">{currentSelectedCustomer.name}</h3><div className="text-xs text-indigo-600 font-bold mt-1">總額: ${currentSelectedCustomer.totalSpent.toLocaleString()}</div></div>
                                    <div className="flex gap-2">
                                        <button onClick={()=>handleExportToImage(currentSelectedCustomer)} className="p-2 bg-slate-100 rounded-full flex gap-1 text-xs items-center font-bold" title="匯出圖片"><ImageIcon size={16}/> 存成圖片</button>
                                        <button onClick={()=>{setProxyForm(prev=>({...prev,customer:currentSelectedCustomer.name}));setShowProxyOrder(true)}} className="p-2 bg-slate-100 rounded-full"><Plus size={18}/></button>
                                        <button onClick={()=>setSelectedCustomerDetail(null)} className="p-2 bg-slate-100 rounded-full"><X size={18}/></button>
                                    </div>
                                </div>
                                <div className="flex-1 overflow-y-auto p-4 space-y-2">
                                    {currentSelectedCustomer.items.map((item,idx)=>(
                                        <div key={idx} className="flex justify-between items-center p-3 border-b">
                                            <div><div className="font-bold text-sm">{item.name}</div><div className="text-xs text-slate-500">{item.variant} · ${item.finalPrice}</div></div>
                                            <div className="text-right flex items-center gap-1 justify-end">
                                                <span className="text-xs text-slate-400">x</span>
                                                {editingOrderQtyId===`${item.orderId}-${item.productId}` ? 
                                                    <input autoFocus className="w-8 text-center border rounded" defaultValue={item.qty} onBlur={e=>handleUpdateOrderQty(item.orderId,item.productId,e.target.value)}/> :
                                                    <span onClick={()=>setEditingOrderQtyId(`${item.orderId}-${item.productId}`)} className="font-bold cursor-pointer">{item.qty}</span>
                                                }
                                                <div className="text-xs text-indigo-600 font-bold ml-2">${item.itemTotal}</div>
                                                <button onClick={()=>handleDeleteOrderItem(item.orderId,item.productId)} className="ml-1 text-slate-300 hover:text-rose-500"><Trash2 size={12}/></button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {currentSelectedArrivalCustomer && (
                        <div className="fixed inset-0 bg-black/50 z-[150] flex items-end md:items-center justify-center p-0 md:p-4">
                            <div className="bg-white rounded-t-[30px] md:rounded-3xl w-full max-w-md h-[85vh] flex flex-col">
                                <div className="p-6 bg-slate-800 text-white rounded-t-[30px] flex justify-between items-start shrink-0">
                                    <div><h3 className="text-xl font-bold">{currentSelectedArrivalCustomer.name}</h3><p className="text-xs opacity-70 mt-1">{isArrivalShipped ? '已出貨' : '配貨檢核'}</p></div>
                                    <button onClick={()=>setSelectedArrivalCustomer(null)} className="bg-white/20 p-2 rounded-full"><X size={18}/></button>
                                </div>
                                <div className="px-6 py-3 bg-slate-800 text-white flex justify-between items-center shrink-0">
                                    <div className="text-xs opacity-80">進度: {currentSelectedArrivalCustomer.arrivedItemsCount} / {currentSelectedArrivalCustomer.totalItemsCount} 項</div>
                                    {!isArrivalShipped && currentSelectedArrivalCustomer.isFullyArrived && <button onClick={()=>handleShipCustomer(currentSelectedArrivalCustomer.name)} className="bg-emerald-500 px-3 py-1 rounded-lg text-xs font-bold flex gap-1 shadow animate-pulse"><Truck size={14}/> 確認出貨</button>}
                                    {isArrivalShipped && <button onClick={()=>handleUnshipCustomer(currentSelectedArrivalCustomer.name)} className="bg-amber-500 px-3 py-1 rounded-lg text-xs font-bold flex gap-1 shadow"><Undo2 size={14}/> 回復未出貨</button>}
                                </div>
                                <div className="flex-1 overflow-y-auto p-4 space-y-3">
                                    {currentSelectedArrivalCustomer.items.map((item,idx)=>{
                                        const isDone = (item.allocatedQty||0) >= item.qty;
                                        return (
                                            <div key={idx} className={`flex justify-between items-center p-3 border rounded-xl ${isDone?'bg-emerald-50 border-emerald-200':'bg-white'} ${isArrivalShipped?'opacity-70':''}`}>
                                                <div className="flex items-center gap-3 flex-1">
                                                    {!isArrivalShipped ? (
                                                        <button onClick={()=>toggleAllocation(item.orderId,item.productId,item.allocatedQty||0,item.qty)} className={`w-6 h-6 rounded border flex items-center justify-center ${isDone?'bg-emerald-500 border-emerald-500 text-white':''}`}><CheckSquare size={14}/></button>
                                                    ) : <div className="w-6 h-6 flex items-center justify-center bg-gray-200 rounded text-gray-500"><PackageCheck size={14}/></div>}
                                                    <div><div className="font-bold text-sm text-slate-700">{item.name}</div><div className="text-[10px] text-slate-500">{item.variant}</div></div>
                                                </div>
                                                <div className="flex items-center gap-1 text-sm">
                                                    <span className="text-xs text-slate-400">配</span>
                                                    {!isArrivalShipped && editingAllocatedQtyId===`${item.orderId}-${item.productId}-arrival` ?
                                                        <input autoFocus className="w-8 text-center border-b border-indigo-500 outline-none bg-transparent" defaultValue={item.allocatedQty||0} onBlur={e=>handleUpdateAllocatedQty(item.orderId,item.productId,e.target.value)}/> :
                                                        <span onClick={()=>!isArrivalShipped && setEditingAllocatedQtyId(`${item.orderId}-${item.productId}-arrival`)} className={`font-bold ${isDone?'text-emerald-600':'text-indigo-600'} ${!isArrivalShipped && 'cursor-pointer'}`}>{item.allocatedQty||0}</span>
                                                    }
                                                    <span className="text-xs text-slate-400">/ 訂</span>
                                                    {!isArrivalShipped && editingOrderQtyId===`${item.orderId}-${item.productId}-arrival` ?
                                                        <input autoFocus className="w-8 text-center border-b border-slate-500 outline-none bg-transparent" defaultValue={item.qty} onBlur={e=>handleUpdateOrderQty(item.orderId,item.productId,e.target.value)}/> :
                                                        <span onClick={()=>!isArrivalShipped && setEditingOrderQtyId(`${item.orderId}-${item.productId}-arrival`)} className="font-bold cursor-pointer">{item.qty}</span>
                                                    }
                                                </div>
                                            </div>
                                        )
                                    })}
                                </div>
                            </div>
                        </div>
                    )}

                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
